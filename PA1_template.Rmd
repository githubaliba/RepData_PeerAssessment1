# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
First, we load the data.  We use parameterize the directory and create the directory if needed.

```{r createDir}
dataDir <- "./data"
if(!file.exists(dataDir)) {dir.create(dataDir)}
```

Next, we parameterize the URL and filename, and download the file.
```{r downloadFile}
fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destFileName <- "activity.zip"
fullDataPathFile <- paste(dataDir,"/",destFileName,sep="")
download.file(fileUrl,destfile=fullDataPathFile,method="curl")
```

Last, we unzip the file to the data directory and load it into the activity data frame.
```{r unzipLoadFile}
unzip("./data/activity.zip",exdir=dataDir)
activity <- read.csv("./data/activity.csv")
```

To make things a little easier, we are going to leverage the melt function from the reshape2 library, so we have to install and load that now.

```{r loadReshape2}
if(!require("reshape2"))
{
  install.packages("reshape2",repos="http://cran.rstudio.com/")
  library(reshape2)
}
```

Next we "melt" the activity table to allow us to perform some easier operations.

```{r meltActivityMelt}
activityMelt <- melt(activity,id=c("date","interval"),measure.vars=c("steps"))
```

At this point, we are ready to begin the analysis.

## What is mean total number of steps taken per day?

Here we are going to leverage the "melted" data to create a new data frame that is the dates and the sum of steps each day.
```{r createDateTotalActivity}
dateTotalActivity <- dcast(activityMelt, date ~ variable, sum)
```

After that, we can easily generate a histogram of the data using the code below.  Note we generated additional breaks to get a better characterization of the distribution.  We also include a quick summary of the data.
```{r historgram}
hist(dateTotalActivity$steps,breaks=10,xlab="Total Steps Per Day",main="Histogram of Total Daily Steps")
summary(dateTotalActivity$steps)
```

Using the na.rm option, we get an adjusted mean and median here.
```{r statistics} 
mean(dateTotalActivity$steps,na.rm=TRUE)
median(dateTotalActivity$steps,na.rm=TRUE)
```


## What is the average daily activity pattern?
```{r}
intervalAverageActivity <- dcast(activityMelt, interval ~ variable, mean,na.rm=TRUE)
plot(intervalAverageActivity$interval,intervalAverageActivity$steps,type="l",xlab="Interval Number",ylab="Average Daily Steps")
intervalAverageActivity[intervalAverageActivity$steps == max(intervalAverageActivity$steps),]
intervalAverageActivity[intervalAverageActivity$steps == max(intervalAverageActivity$steps),]$interval
```


## Imputing missing values
```{r}
sum(is.na(activity$steps))
library(plyr)
```


## Are there differences in activity patterns between weekdays and weekends?

```{r loadLattice}
if(!require("lattice"))
{
  install.packages("lattice",repos="http://cran.rstudio.com/")
  library(lattice)
}
```
```{r}
activity$day = weekdays(as.Date(activity$date))
activity$dayType = ifelse(activity$day == "Sunday" | activity$day == "Saturday","Weekend","Weekday")
activity$dayType <- factor(activity$dayType)
activity$day <- factor(activity$day)
xyplot(steps~interval |dayType, activity,type="l",layout=c(1,2))
xyplot(steps~interval |day, activity,type="l",layout=c(3,3))
```

